<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Password Helper</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      --bg:#f3f4f6;
      --card:#ffffff;
      --accent:#2563eb;
      --accent-soft:rgba(37,99,235,0.08);
      --border:#e5e7eb;
      --text:#111827;
      --muted:#6b7280;
      --radius:14px;
      --shadow:0 14px 32px rgba(15,23,42,0.12);
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;
      background:radial-gradient(circle at top,#e5e7eb 0,#f9fafb 40%,#ffffff 100%);
      color:var(--text);padding:24px;
    }

    .wrap{
      width:100%;max-width:560px;background:var(--card);padding:22px;border-radius:18px;
      box-shadow:var(--shadow);border:1px solid var(--border);
    }
    .title{display:flex;align-items:center;gap:10px;margin:0 0 6px;font-weight:600;font-size:1.25rem}
    .logo{width:28px;height:28px;border-radius:7px;display:inline-flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg,#2563eb,#60a5fa);color:#fff;font-weight:700}
    .subtitle{margin:0 0 14px;color:var(--muted);font-size:0.92rem}

    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .btn{
      border:1px solid var(--border);padding:8px 12px;border-radius:999px;background:#f9fafb;color:var(--text);
      cursor:pointer;font-size:0.92rem;display:inline-flex;align-items:center;gap:8px;
      transition:transform .12s ease,box-shadow .12s ease,background .12s ease
    }
    .btn.primary{background:var(--accent);color:#fff;border-color:var(--accent);box-shadow:0 8px 18px rgba(37,99,235,.25)}
    .btn:hover{transform:translateY(-2px);box-shadow:0 10px 20px rgba(15,23,42,.08);background:#eff6ff}
    #btnSimple:hover{color:#111;background:#dbeafe}

    .password-label{font-size:.72rem;color:var(--accent);text-transform:uppercase;letter-spacing:.12em;margin-bottom:6px}
    .password-box{display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:10px;border-radius:14px;background:#f9fafb;border:1px solid var(--border)}
    .password-output{font-family:"SF Mono",Menlo,Consolas,monospace;font-size:1.06rem;color:var(--text);
      cursor:pointer;user-select:none;padding:6px 8px;border-radius:8px;flex:1;overflow-x:auto;white-space:nowrap}
    .password-output:hover{background:var(--accent-soft)}
    .copy-btn{border:none;border-radius:999px;padding:6px 10px;background:var(--accent-soft);color:var(--accent);cursor:pointer}

    /* Modal */
    .overlay{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:none;align-items:center;justify-content:center;z-index:60}
    .modal{background:var(--card);padding:18px;border-radius:12px;max-width:640px;width:92%;box-shadow:0 18px 40px rgba(0,0,0,.35);border:1px solid var(--border)}
    .modal h3{margin:0 0 8px;font-size:1rem}
    .code{font-family:Consolas,"Courier New",monospace;background:#0f172a;color:#dbeafe;padding:12px;border-radius:8px;overflow:auto;font-size:0.95rem}
    .modal .m-controls{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    .modal .m-btn{padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:#f9fafb;cursor:pointer}
    .modal .m-btn.primary{background:var(--accent);color:#fff;border-color:var(--accent)}

    @media (max-width:460px){
      .title{font-size:1.05rem}
      .password-output{font-size:1rem}
    }
  </style>
</head>
<body>
  <div class="wrap" id="app">
    <div class="title"><span class="logo">P</span>Password Helper</div>
    <p class="subtitle">Generate simple or strong, easy-to-remember passwords. Click the password to copy.</p>

    <div class="controls">
      <button id="btnSimple" class="btn primary">üôÇ Simple</button>
      <button id="btnStrong" class="btn">üõ°Ô∏è Strong</button>
      <button id="btnApi" class="btn">üîó API</button>
    </div>

    <div class="password-label" id="passwordLabel">Simple password</div>
    <div class="password-box">
      <div id="passwordOutput" class="password-output" title="Click to copy"></div>
      <button id="copyBtn" class="copy-btn">Copy üìã</button>
    </div>
  </div>

  <!-- Modal / Popup for API snippet -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="apiTitle">
      <h3 id="apiTitle">PowerShell example</h3>
      <div class="code" id="apiCode" tabindex="0">
$Password = Invoke-RestMethod -Uri https://password.danieltesting.space/simple
      </div>
      <div class="m-controls">
        <button id="copyApi" class="m-btn">Copy</button>
        <button id="closeApi" class="m-btn primary">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Front-end uses the Pages Functions endpoints (/simple and /strong).
    const out = document.getElementById('passwordOutput');
    const copyBtn = document.getElementById('copyBtn');
    const btnSimple = document.getElementById('btnSimple');
    const btnStrong = document.getElementById('btnStrong');
    const btnApi = document.getElementById('btnApi');

    const overlay = document.getElementById('overlay');
    const apiCode = document.getElementById('apiCode');
    const copyApi = document.getElementById('copyApi');
    const closeApi = document.getElementById('closeApi');

    async function fetchPassword(type){
      try {
        const r = await fetch('/' + type, { cache: "no-store" });
        if (!r.ok) throw new Error('Network error');
        return await r.text();
      } catch (e) {
        return 'Error';
      }
    }

    async function showPassword(type){
      out.textContent = '‚Ä¶';
      const pwd = await fetchPassword(type);
      out.textContent = pwd;
      document.getElementById('passwordLabel').textContent = type === 'strong' ? 'Strong password' : 'Simple password';
    }

    async function copyText(text){
      if (!text) return;
      try {
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = 'Copied ‚úÖ';
        setTimeout(()=>copyBtn.textContent = 'Copy üìã',900);
      } catch {
        const fallback = document.createElement('textarea');
        fallback.value = text;
        document.body.appendChild(fallback);
        fallback.select();
        try { document.execCommand('copy'); copyBtn.textContent = 'Copied ‚úÖ'; }
        catch { copyBtn.textContent = 'Copy failed'; }
        fallback.remove();
        setTimeout(()=>copyBtn.textContent = 'Copy üìã',900);
      }
    }

    // click-to-copy for password text
    out.addEventListener('click', () => copyText(out.textContent));
    copyBtn.addEventListener('click', () => copyText(out.textContent));

    btnSimple.addEventListener('click', () => showPassword('simple'));
    btnStrong.addEventListener('click', () => showPassword('strong'));

    // API popup logic
    btnApi.addEventListener('click', () => {
      overlay.style.display = 'flex';
      overlay.setAttribute('aria-hidden','false');
      // focus for keyboard users
      apiCode.focus();
      // ensure code contains exact snippet (hard-coded as requested)
      apiCode.textContent = '$Password = Invoke-RestMethod -Uri https://password.danieltesting.space/simple';
    });

    closeApi.addEventListener('click', () => {
      overlay.style.display = 'none';
      overlay.setAttribute('aria-hidden','true');
      btnApi.focus();
    });

    // copy snippet from modal
    copyApi.addEventListener('click', async () => {
      const text = apiCode.textContent.trim();
      try {
        await navigator.clipboard.writeText(text);
        copyApi.textContent = 'Copied ‚úÖ';
        setTimeout(()=>copyApi.textContent = 'Copy',900);
      } catch {
        copyApi.textContent = 'Copy failed';
        setTimeout(()=>copyApi.textContent = 'Copy',900);
      }
    });

    // close modal on overlay click (but not when clicking inside modal)
    overlay.addEventListener('click', (ev) => {
      if (ev.target === overlay) {
        overlay.style.display = 'none';
        overlay.setAttribute('aria-hidden','true');
      }
    });

    // keyboard: Esc closes modal
    document.addEventListener('keydown', (ev) => {
      if (ev.key === 'Escape' && overlay.style.display === 'flex') {
        overlay.style.display = 'none';
        overlay.setAttribute('aria-hidden','true');
      }
    });

    // start with simple password
    showPassword('simple');
  </script>
</body>
</html>
